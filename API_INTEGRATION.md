# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API Deadline Bot

–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å API https://deadlinetaskbot.productlove.ru/api/v1

## üìã –ò–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ù–æ–≤—ã–π —Ñ–∞–π–ª: `src/services/deadlineTaskApi.ts`
–ö–ª–∞—Å—Å `DeadlineTaskApi` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º API. –ú–µ—Ç–æ–¥—ã:
- `createTask()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
- `deleteTask(taskId)` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–æ ID
- `deleteAllCancelledTasks()` - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- `getMyTasks(offset, limit)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–æ–∏—Ö –∑–∞–¥–∞—á
- `getTask(taskId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏
- `updateTask(taskId, updates)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
- `publishTask(taskId)` - –ø–µ—Ä–µ–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è –∑–∞–¥–∞—á–∏

### 2. –û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª: `.env`
```env
BOT_API_URL=https://deadlinetaskbot.productlove.ru/api/v1
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤ `src/index.ts`:

#### POST `/tasks/send`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –ø–∞–ø–∫–∏ `data/` –Ω–∞ —Å–µ—Ä–≤–µ—Ä Deadline Bot

**Request:**
```bash
curl -X POST http://localhost:3000/tasks/send
```

**Response:**
```json
{
  "success": true,
  "message": "Processed 15 jobs, sent: 12",
  "report": {
    "timestamp": "2026-01-24T...",
    "statistics": {
      "total": 15,
      "sent": 12,
      "skipped": 3,
      "errors": 0
    },
    "results": [...]
  }
}
```

#### DELETE `/tasks/delete`
–£–¥–∞–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Deadline Bot

**Request (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ):**
```bash
curl -X DELETE http://localhost:3000/tasks/delete \
  -H "Content-Type: application/json" \
  -d '{"clearAll": true}'
```

**Request (—É–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏):**
```bash
curl -X DELETE http://localhost:3000/tasks/delete \
  -H "Content-Type: application/json" \
  -d '{"taskIds": ["task_1", "task_2", "task_3"]}'
```

**Response:**
```json
{
  "success": true,
  "message": "Successfully deleted 5 tasks",
  "deleted": 5,
  "totalDeleted": 5,
  "botResults": [
    {
      "taskId": "task_1",
      "status": "‚úÖ deleted"
    }
  ]
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
npm run test:api
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
```bash
npx ts-node test-api.ts
```

## üîë –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `BOT_TOKEN` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ `.env`
2. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `BOT_API_URL` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ https://deadlinetaskbot.productlove.ru/api/v1

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í `.env`:
- `BOT_TOKEN` - –≤–∞—à —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞
- `MAX_JOBS_TO_PROCESS` - –º–∞–∫—Å–∏–º—É–º –∑–∞–¥–∞—á –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞ —Ä–∞–∑ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15)
- `API_DELAY_MIN` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ –º—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- `API_DELAY_MAX` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ –º—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100)

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ùå –û—à–∏–±–∫–∏
- ‚ÑπÔ∏è  –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ `data/` –≤ Deadline Bot API:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
npm start

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞—á–∏
curl -X POST http://localhost:3000/tasks/send

# –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á–∏
curl -X DELETE http://localhost:3000/tasks/delete -d '{"clearAll": true}'
```

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è rate limit
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –≤ `sent_jobs_database.json`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–¥–Ω—É –∑–∞–¥–∞—á—É –¥–≤–∞–∂–¥—ã)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
